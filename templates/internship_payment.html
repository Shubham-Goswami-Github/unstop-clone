{% load static %}
{% block content %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">

<style>
  body {
    background: linear-gradient(135deg, #f4f7fc, #e8f0fe);
    font-family: 'Segoe UI', sans-serif;
    color: #003366;
    padding-bottom: 50px;
  }

  .checkout-header {
    text-align: center;
    padding: 20px 0;
    animation: fadeInDown 0.6s;
  }

  .checkout-header img {
    height: 60px;
    margin-bottom: 10px;
  }

  .checkout-header h2 {
    color: #002244;
    font-weight: bold;
  }

  .form-section, .cart-summary {
    background-color: #ffffff;
    border-radius: 16px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    padding: 25px;
    margin-bottom: 30px;
    animation: fadeInUp 0.6s;
  }

  .cart-summary h4, .form-section h4 {
    color: #002244;
    font-weight: 600;
    margin-bottom: 20px;
  }

  .btn-dark-blue {
    background-color: #002244;
    color: white;
    transition: 0.3s;
  }

  .btn-dark-blue:hover {
    background-color: #001122;
  }

  .badge-free {
    background-color: #00aa55;
    color: #fff;
    padding: 6px 10px;
    border-radius: 5px;
    font-weight: bold;
  }

  .form-check-label i {
    color: #003366;
    margin-right: 8px;
  }

  .form-control:focus {
    border-color: #003366;
    box-shadow: 0 0 5px rgba(0, 51, 102, 0.3);
  }

  @media (max-width: 768px) {
    .form-section, .cart-summary {
      padding: 20px;
    }
  }
</style>

<div class="container mt-5 animate__animated animate__fadeIn">
  <div class="checkout-header">
    <img src="{% static 'images/unstop-logo.svg' %}" alt="Company Logo">
    <h2>Internship Checkout</h2>
    <p class="text-muted">Secure your seat by confirming payment</p>
  </div>

  {% if success_message %}
  <div class="alert alert-primary text-center animate__animated animate__fadeInUp" role="alert">
    <i class="fas fa-check-circle me-2"></i> {{ success_message }}
  </div>
  {% endif %}

  <div class="row justify-content-center">
    <!-- Right Panel -->
    <div class="col-lg-4">
      <div class="cart-summary">
        <h4 class="mb-3">Summary</h4>
        <ul class="list-group">
          <li class="list-group-item">
            <strong>{{ internship.title }}</strong><br>
            <small class="text-muted"><i class="fas fa-building"></i> {{ internship.company_name }}</small>
          </li>
          <li class="list-group-item"><i class="fas fa-layer-group me-2"></i><strong>Domain:</strong> {{ internship.domain }}</li>
          <li class="list-group-item"><i class="fas fa-laptop me-2"></i><strong>Mode:</strong> {{ internship.mode }}</li>
          <li class="list-group-item"><i class="fas fa-clock me-2"></i><strong>Duration:</strong> {{ internship.duration_weeks }} weeks</li>
          <li class="list-group-item"><i class="fas fa-map-marker-alt me-2"></i><strong>Location:</strong> {{ internship.location }}</li>
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <strong>Stipend:</strong>
            {% if internship.stipend_amount == 0 or internship.category == "Unpaid" %}
              <span class="badge-free">Free</span>
            {% else %}
              ₹{{ internship.stipend_amount }}
            {% endif %}
          </li>
          <li class="list-group-item d-flex justify-content-between">
            <span>Total</span>
            <strong>
              {% if internship.stipend_amount == 0 or internship.category == "Unpaid" %}
                ₹0
              {% else %}
                ₹{{ internship.stipend_amount }}
              {% endif %}
            </strong>
          </li>
        </ul>
      </div>
    </div>

    <!-- Left Panel -->
    <div class="col-lg-6">
      <div class="form-section">
        <h4 class="mb-3">Candidate Details</h4>
        <p><strong>Name:</strong> {{ profile.first_name }} {{ profile.last_name }}</p>
        <p><strong>Email:</strong> {{ profile.email }}</p>
        <p><strong>Phone:</strong> {{ profile.phone }}</p>
        <hr class="mb-4">

        <form method="POST" class="needs-validation" novalidate>
          {% csrf_token %}

          {% if internship.stipend_amount > 0 and internship.category == "Paid" %}
            <h5>Choose Payment Option</h5>
            <div class="form-check mb-2">
              <input class="form-check-input" type="radio" name="payment_option" id="pay_now" value="now" checked>
              <label class="form-check-label" for="pay_now">Pay Now</label>
            </div>
            <div class="form-check mb-4">
              <input class="form-check-input" type="radio" name="payment_option" id="pay_later" value="later">
              <label class="form-check-label" for="pay_later">Pay Later</label>
            </div>

            <h5>Payment Method</h5>
            <div class="d-block my-3">
              <div class="form-check">
                <input id="credit" name="paymentMethod" type="radio" class="form-check-input" checked required>
                <label class="form-check-label" for="credit"><i class="fas fa-credit-card"></i> Credit Card</label>
              </div>
              <div class="form-check">
                <input id="debit" name="paymentMethod" type="radio" class="form-check-input" required>
                <label class="form-check-label" for="debit"><i class="fas fa-university"></i> Debit Card</label>
              </div>
              <div class="form-check">
                <input id="wallet" name="paymentMethod" type="radio" class="form-check-input" required>
                <label class="form-check-label" for="wallet"><i class="fas fa-wallet"></i> UPI / Wallet</label>
              </div>
            </div>

            <div class="form-check mt-3 mb-3">
              <input type="checkbox" class="form-check-input" id="terms2" required>
              <label class="form-check-label" for="terms2">I agree to the <a href="#">Terms & Conditions</a>.</label>
            </div>

            <button class="btn btn-dark-blue btn-lg w-100" type="submit">
              <i class="fas fa-lock me-2"></i>
              <span id="pay-label">Pay ₹{{ internship.stipend_amount }}</span>
            </button>
          {% else %}
            <div class="form-check mb-3">
              <input type="checkbox" class="form-check-input" id="terms1" required>
              <label class="form-check-label" for="terms1">I agree to the <a href="#">Terms & Conditions</a>.</label>
            </div>
            <button class="btn btn-dark-blue btn-lg w-100" type="submit">
              <i class="fas fa-save me-2"></i>Confirm
            </button>
          {% endif %}
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  (function () {
    'use strict';
    window.addEventListener('load', function () {
      const forms = document.getElementsByClassName('needs-validation');
      Array.prototype.filter.call(forms, function (form) {
        form.addEventListener('submit', function (event) {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add('was-validated');
        }, false);
      });
    }, false);
  })();
</script>

{% endblock %}
