{% load static %}

<div class="container py-4 px-3 position-relative">
  <!-- Heading -->
  <div class="mb-4 text-start">
    <h2 class="fw-bold mb-1">
      <span style="color: black;">Top</span>
      <span style="color: #0c1e3a;">Competitions</span>
    </h2>
    <p class="text-muted fs-5">Explore challenges, hackathons, quizzes, and more!</p>
  </div>

  <!-- Scroll Buttons -->
  <button class="scroll-btn left-btn btn btn-light shadow-sm position-absolute top-50 translate-middle-y start-0 ms-2 d-none d-md-block" onclick="scrollCompetitions(-1)">
    <i class="fas fa-chevron-left"></i>
  </button>
  <button class="scroll-btn right-btn btn btn-light shadow-sm position-absolute top-50 translate-middle-y end-0 me-2 d-none d-md-block" onclick="scrollCompetitions(1)">
    <i class="fas fa-chevron-right"></i>
  </button>

  <!-- Competition Cards -->
  <div id="competition-carousel" class="scrolling-wrapper d-flex gap-3 px-2">
    {% for item in competitions %}
    <div class="opportunity-card glass-card d-flex flex-column justify-content-between p-3 rounded-4">
      <div>
        <div class="mb-2 d-flex justify-content-between flex-wrap gap-1">
          <span class="badge bg-dark-blue text-white text-capitalize">{{ item.competition_type }}</span>
          <span class="badge bg-dark-blue text-white text-capitalize">{{ item.mode }}</span>
        </div>
        <h5 class="fw-bold mb-1">{{ item.title|truncatechars:40 }}</h5>
        <p class="text-muted mb-1"><i class="fas fa-building me-1 text-dark"></i> {{ item.host_org }}</p>
        <p class="mb-1"><strong>Category:</strong> {{ item.category }}</p>
        {% if item.fee_amount %}
        <p class="mb-1"><strong>Fee:</strong> ₹{{ item.fee_amount }}</p>
        {% endif %}
        {% if item.prize_pool %}
        <p class="mb-1"><strong>Prize:</strong> {{ item.prize_pool }}</p>
        {% endif %}
        <p class="mb-2 text-muted"><small>Deadline: {{ item.registration_deadline }}</small></p>
      </div>
       <!-- ✅ NEW -->
<a href="{% url 'competition_detail_user' item.pk %}" class="btn btn-dark-blue w-100 mt-2 apply-btn">
  <i class="fas fa-paper-plane me-1"></i> Participate
</a>
    </div>
    {% endfor %}
  </div>
</div>

<style>
.scrolling-wrapper {
  overflow-x: hidden;
  scroll-behavior: smooth;
  margin-inline: 10px;
}

.opportunity-card {
  flex: 0 0 20%;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
@media (max-width: 992px) {
  .opportunity-card {
    flex: 0 0 30%;
  }
}
@media (max-width: 768px) {
  .opportunity-card {
    flex: 0 0 90%;
  }
}

.opportunity-card:hover {
  transform: translateY(-6px) scale(1.01);
  box-shadow: 0 12px 28px rgba(0, 0, 0, 0.15);
}

.glass-card {
  background: rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(12px);
  border: 1px solid rgba(255, 255, 255, 0.25);
  color: #000;
  min-height: 320px;
}

.scroll-btn {
  z-index: 2;
  border-radius: 50%;
  width: 40px;
  height: 40px;
}

.bg-dark-blue {
  background-color: #0c1e3a !important;
}
.btn-dark-blue {
  background-color: #0c1e3a;
  color: #fff;
  border: none;
  transition: background-color 0.3s ease, transform 0.3s ease;
}
.btn-dark-blue:hover {
  background-color: #0a1730;
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(12, 30, 58, 0.3);
}
</style>

<script>
function scrollCompetitions(direction) {
  const container = document.getElementById('competition-carousel');
  const scrollAmount = 300;
  container.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
}
</script>