{% extends "navbar.html" %}
{% load static %}
{% block content %}

<style>
.hero-section {
  display: flex; justify-content: center; align-items: center;
  padding: 50px 60px; background: #f8f9fa; gap: 40px; flex-wrap: wrap;
}
.hero-text { flex: 1; max-width: 500px; }
.hero-text h1 { font-size: 3.5rem; font-weight: 700; }
.hero-text .unlock { background: #003366; color: #fff; padding: 5px 15px; border-radius: 5px; }
.hero-text .opportunities { color: #003366; margin-left: 10px; }
.hero-image { flex: 1; display: flex; justify-content: flex-end; }
.hero-image img { max-width: 400px; border-radius: 10px; width: 100%; }

.filter-section { padding: 30px 10px; background: #fff; }
.filter-buttons-group {
  display: flex; flex-wrap: wrap; justify-content: center;
  gap: 15px; margin-bottom: 10px;
}
.filter-buttons-group button {
  background: #003366; color: #fff; border: none; padding: 10px 25px;
  border-radius: 6px; font-weight: 500; cursor: pointer; transition: .3s;
}
.filter-buttons-group button.active {
  background: #0056b3; transform: scale(1.08);
}

.cards-grid {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 30px; padding: 40px 20px; max-width: 1200px; margin: auto;
}
.banner-card {
  background: #fff; border-radius: 12px; padding: 25px 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,.1);
  display: flex; flex-direction: column; align-items: center;
  text-align: center; transition: .3s; border: 1px solid transparent;
}
.banner-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 8px 24px rgba(0,0,0,.15);
  border-color: #00336630;
}
.banner-card .icon {
  font-size: 45px; margin-bottom: 15px; color: #003366; transition: .4s;
}
.banner-card:hover .icon { transform: scale(1.2) rotate(10deg); }
.banner-card h5 { font-weight: 600; font-size: 1.2rem; margin-bottom: 5px; }
.banner-card p { font-size: .9rem; color: #555; margin: 0; }
.view-btn { margin-top: 15px; }
.view-btn:hover { background: #003366; color: #fff; }

@media(max-width:576px){
  .filter-buttons-group { flex-direction: column; gap: 10px; }
}
</style>

<!-- ===== Hero ===== -->
<div class="hero-section">
  <div class="hero-text">
    <h1><span class="unlock">UNLOCK</span><span class="opportunities">OPPORTUNITIES</span></h1>
  </div>
  <div class="hero-image">
    <img src="{% static 'images/c1.webp' %}" alt="Hero">
  </div>
</div>

<!-- ===== Filters ===== -->
<div class="filter-section">
  <div class="filter-buttons-group">
    <button id="allBtn" onclick="setType('all')" class="active">Show All</button>
    {% for key, label in competition_type_choices %}
    <button id="{{ key|slugify }}Btn" onclick="setType('{{ key }}')">{{ label }}</button>
    {% endfor %}
  </div>
</div>

<!-- ===== Competition Cards ===== -->
<div class="cards-grid" id="compCards">
  {% for comp in competitions %}
  <div class="banner-card" data-type="{{ comp.competition_type }}">
    <i class="fas fa-trophy icon"></i>
    <h5>{{ comp.title|truncatechars:40 }}</h5>
    <p><strong>{{ comp.host_org }}</strong></p>
    <span class="badge bg-secondary">{{ comp.mode }} • {{ comp.category }}</span>
    <p class="mt-2 small">
      {{ comp.competition_type }}{% if comp.registration_deadline %} • Apply by {{ comp.registration_deadline }}{% endif %}
    </p>
    <a href="{% url 'competition_detail_user' comp.pk %}" class="btn btn-sm btn-outline-primary view-btn">View Details</a>
  </div>
  {% empty %}
    <p class="text-center text-muted">No competitions available.</p>
  {% endfor %}
</div>

<!-- ===== JS ===== -->
<script>
let compType = null;

function setType(t){
  compType = (t === 'all') ? null : t;
  document.querySelectorAll('.filter-buttons-group button').forEach(btn => btn.classList.remove('active'));
  document.getElementById((t === 'all' ? 'all' : t.toLowerCase().replace(/\s/g, '-') ) + 'Btn')?.classList.add('active');

  document.querySelectorAll('.banner-card').forEach(card => {
    const show = !compType || card.dataset.type === compType;
    card.style.display = show ? 'flex' : 'none';
  });
}
window.addEventListener('load', setType.bind(null, 'all'));
</script>
<body>
  <!-- content -->
  
  <div class="bottom-footer-wrapper">
    {% include 'bottom_menu.html' %}
  </div>

  <style>
    footer.bg-footer {
      margin-left: calc(-1 * (100vw - 100%)/2);
      margin-right: calc(-1 * (100vw - 100%)/2);
      width: 100vw;
    }
  </style>
</body>
{% endblock %}
