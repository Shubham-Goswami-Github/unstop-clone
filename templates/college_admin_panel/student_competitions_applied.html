{% extends 'college_admin_panel/college_admin_base.html' %}
{% load static %}

{% block content %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<div class="container mt-4">
  <h4 class="mb-4 text-success">Competitions Applied by {{ student.first_name }} {{ student.last_name }}</h4>

  {% if competitions %}
    <div class="table-responsive">
      <table class="table table-bordered table-hover align-middle">
        <thead class="table-dark">
          <tr>
            <th>#</th>
            <th>Title</th>
            <th>Host</th>
            <th>Category</th>
            <th>Type</th>
            <th>Mode</th>
            <th>Team Size</th>
            <th>Prize Pool</th>
            <th>Fee</th>
            <th>Start</th>
            <th>End</th>
            <th>Reg. Deadline</th>
            <th>Applied On</th>
            <th>Link</th>
          </tr>
        </thead>
        <tbody>
          {% for applied in competitions %}
          {% with comp=applied.competition %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td><i class="fas fa-trophy text-warning me-1"></i>{{ comp.title }}</td>
            <td>{{ comp.host_org }}</td>
            <td>{{ comp.category }}</td>
            <td>{{ comp.competition_type }}</td>
            <td>{{ comp.get_mode_display }}</td>
            <td>{{ comp.team_size }}</td>
            <td>
              {% if comp.prize_pool %}
                ₹{{ comp.prize_pool }}
              {% else %}
                N/A
              {% endif %}
            </td>
            <td>
              {% if comp.fee_amount == 0 %}
                Free
              {% else %}
                ₹{{ comp.fee_amount }}
              {% endif %}
            </td>
            <td>{{ comp.start_date }}</td>
            <td>{{ comp.end_date }}</td>
            <td>{{ comp.registration_deadline }}</td>
            <td>{{ applied.applied_at|date:"d M Y, h:i A" }}</td>
            <td>
              {% if comp.application_link %}
              <a href="{{ comp.application_link }}" target="_blank" class="btn btn-sm btn-outline-primary">
                <i class="fas fa-external-link-alt"></i>
              </a>
              {% else %}
              <span class="text-muted">N/A</span>
              {% endif %}
            </td>
          </tr>
          {% endwith %}
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="alert alert-info">No competition applications found for this student.</div>
  {% endif %}

  <a href="{% url 'registered_students' %}" class="btn btn-outline-dark mt-3">
    <i class="fas fa-arrow-left me-1"></i> Back to Students
  </a>
</div>
{% endblock %}
