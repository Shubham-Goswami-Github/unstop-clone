{% load static %}
{% block content %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">

<style>
  body {
    background: linear-gradient(135deg, #f4f7fc, #e8f0fe);
    font-family: 'Segoe UI', sans-serif;
    color: #003366;
    padding-bottom: 50px;
  }

  .checkout-header {
    text-align: center;
    padding: 20px 0;
    animation: fadeInDown 0.6s;
  }

  .checkout-header img {
    height: 60px;
    margin-bottom: 10px;
  }

  .checkout-header h2 {
    color: #002244;
    font-weight: bold;
  }

  .form-section, .job-summary {
    background-color: #ffffff;
    border-radius: 16px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    padding: 25px;
    margin-bottom: 30px;
    animation: fadeInUp 0.6s;
  }

  .btn-dark-blue {
    background-color: #002244;
    color: white;
    transition: 0.3s;
  }

  .btn-dark-blue:hover {
    background-color: #001122;
  }

  .form-control:focus {
    border-color: #003366;
    box-shadow: 0 0 5px rgba(0, 51, 102, 0.3);
  }

  @media (max-width: 768px) {
    .form-section, .job-summary {
      padding: 20px;
    }
  }
</style>

<div class="container mt-5 animate__animated animate__fadeIn">
  <div class="checkout-header">
    <img src="{% static 'images/unstop-logo.svg' %}" alt="Company Logo">
    <h2>Job Application</h2>
    <p class="text-muted">Fill the form to apply</p>
  </div>

  {% if success_message %}
  <div class="alert alert-success text-center animate__animated animate__fadeInUp" role="alert">
    <i class="fas fa-check-circle me-2"></i> {{ success_message }}
  </div>
  {% elif info_message %}
  <div class="alert alert-info text-center animate__animated animate__fadeInUp" role="alert">
    <i class="fas fa-info-circle me-2"></i> {{ info_message }}
  </div>
  {% endif %}

  <div class="row justify-content-center">
    <!-- Job Summary -->
    <div class="col-lg-4">
      <div class="job-summary">
        <h4 class="mb-3">Job Summary</h4>
        <ul class="list-group">
          <li class="list-group-item">
            <strong>{{ job.title }}</strong><br>
            <small class="text-muted"><i class="fas fa-building"></i> {{ job.company_name }}</small>
          </li>
          <li class="list-group-item"><i class="fas fa-layer-group me-2"></i><strong>Domain:</strong> {{ job.domain }}</li>
          <li class="list-group-item"><i class="fas fa-briefcase me-2"></i><strong>Type:</strong> {{ job.employment_type }}</li>
          <li class="list-group-item"><i class="fas fa-map-marker-alt me-2"></i><strong>Location:</strong> {{ job.location }}</li>
          <li class="list-group-item">
            <i class="fas fa-globe me-2"></i><strong>Remote Allowed:</strong>
            {% if job.remote_allowed %}
              <span class="badge bg-success">Yes</span>
            {% else %}
              <span class="badge bg-danger">No</span>
            {% endif %}
          </li>
          <li class="list-group-item"><i class="fas fa-signal me-2"></i><strong>Experience:</strong> {{ job.experience_level }}</li>
          <li class="list-group-item"><i class="fas fa-calendar-alt me-2"></i><strong>Apply By:</strong> {{ job.apply_by }}</li>
        </ul>
      </div>
    </div>

    <!-- Application Form -->
    <div class="col-lg-6">
      <div class="form-section">
        <h4 class="mb-3">Candidate Details</h4>
        <p><strong>Name:</strong> {{ profile.first_name }} {{ profile.last_name }}</p>
        <p><strong>Email:</strong> {{ profile.email }}</p>
        <p><strong>Phone:</strong> {{ profile.phone }}</p>
        <hr class="mb-4">

        {% if already_applied %}
          <div class="alert alert-info mt-3">
            <i class="fas fa-check-circle me-2"></i>You have already applied for this job.
          </div>
        {% else %}
          <form method="POST" class="needs-validation" novalidate>
            {% csrf_token %}
            <div class="form-check mb-3">
              <input type="checkbox" class="form-check-input" id="agree" required>
              <label class="form-check-label" for="agree">I agree to the <a href="#">Terms & Conditions</a>.</label>
            </div>
            <button type="submit" class="btn btn-dark-blue btn-lg w-100">
              <i class="fas fa-paper-plane me-2"></i> Submit Application
            </button>
          </form>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<script>
  (function () {
    'use strict';
    window.addEventListener('load', function () {
      const forms = document.getElementsByClassName('needs-validation');
      Array.prototype.forEach.call(forms, function (form) {
        form.addEventListener('submit', function (event) {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add('was-validated');
        }, false);
      });
    }, false);
  })();
</script>
{% endblock %}
